# ADUC Cleanup Script - Disable Inactive AD Users and Generate Report

# Import AD Module (Windows Server/RSAT required)
Import-Module ActiveDirectory

# Set inactivity threshold (in days)
$DaysInactive = 90
$Time = (Get-Date).AddDays(-$DaysInactive)

# Find inactive users
$InactiveUsers = Get-ADUser -Filter {Enabled -eq $True -and LastLogonDate -lt $Time} -Properties LastLogonDate

# Output report of users to be disabled
$InactiveUsers | Select-Object Name, SamAccountName, LastLogonDate | Export-Csv "InactiveADUsers.csv" -NoTypeInformation

# Disable accounts (Uncomment the next line for production use!)
# $InactiveUsers | ForEach-Object { Disable-ADAccount $_ }

Write-Host "$($InactiveUsers.Count) inactive user accounts found and reported."
Write-Host "Report saved to InactiveADUsers.csv"
# (You can also email the report or add notification steps)
